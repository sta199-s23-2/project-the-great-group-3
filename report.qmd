---
title: "Project title"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

```{r}
#| label: load-pkgs


library(tidyverse)
library(tidymodels)
```

```{r}
#| label: load-data

EADA_2021 = read.csv("data/Copy of EADA_2021.csv")


eada <- EADA_2021[,-27:-4274]
eada <- eada |> 
  mutate(ratio_mw_sa = STUAID_MEN_RATIO/STUAID_WOMEN_RATIO)
eada <- eada |>
  mutate(ratio_mw_ep = RECRUITEXP_MEN/RECRUITEXP_WOMEN)
eada <- eada |>
  filter(ratio_mw_sa != "NaN",
         ratio_mw_ep != "NaN",
         ratio_mw_sa != "Inf",
         ratio_mw_ep != "Inf")
glimpse(eada)
```

**Introduction**

**Context**

Duke University is intrinsically connected to its sports program. Most famously known for their Men's Division 1 Basketball and Football teams, as of 2020, Duke makes an estimated \$33,382,946 and \$39,669,829 in revenue, respectively (Laster, Jordan, et al. "The Haves and the Have-Nots: Inequities Amongst Duke University's Sports Teams." The Haves and the Have-Nots: Inequities Amongst Duke University's Sports Teams \| Black In Blue, 2020, https://blackinblue.trinity.duke.edu/haves-and-have-nots-inequities-amongst-duke-universitys-sports-teams.). Furthermore, Duke spends approximately \$1,329,949 per Men's basketball player and \$217,047 per football player (Ibid.). Duke's 2020 Equity in Athletics Disclosure Act (EADA) revealed that Duke spent a total of \$57,114,331 on men's sports teams and a total of \$25,472,405 on women's sports teams (Ibid.) This figure includes recruitment cost, amongst other things. Nationwide, there is a recorded inequity between NCAA sports (Meredith, L. (2017, June 21). NCAA Title IX Report: Spending up, gender gaps remain. The Seattle Times. https://www.seattletimes.com/sports/ncaa-title-ix-report-spending-up-gender-gaps-remain/). As Duke students, we were curious: is this the status quo in collegiate athletics?

**Explanation of Topic**

Our topic will specifically observe and investigate how much, on average, universities spend on recruitment. We will create a model that predicts this figure, based on the current a university's expenditure on athletic scholarships for student athletes. We will break down a number of variables within the data, looking at whether the institution is public versus private, has a football program or not, and what athletic division it falls under (I, II, or III). Our research question is: To what extent can college athletics' recruitment funds be predicted by the level of athletic scholarships provided to student athletes? We hypothesize that the ratio will, to a high degree, predict the recruitment funding --- as schools who allocate more money into students' financial aid will be willing to designate more money for their recruitment.

**Ethical Issues**

There are very few ethical issues anticipated with this investigation. However, it is important to note that source biases are an likely phenomenon. We must be careful with many self-reported information from university sites, and assuring that the data published can be verified.

**Methodology**

Research question: To what extent can college athletics' recruitment funds be predicted by the level of athletic scholarships provided to student athletes?

-   Private vs. public

-   Football vs. no football

-   Division

We will answer our research question by creating regression models comparing athletic scholarships to recruitment funds, and then calculate the AIC for each model to determine the effectiveness of each predictor. We chose to use regression models because our research question looks at the extent to which one variable can predict another. We chose to use AIC calculations because we are comparing the effectiveness of prediction based on which variables are included in the model, and AIC is an effective calculation for comparing models that is not simply dependent on the number of predictors.

```{r}
#| label: filter-ncaa

eada_NCAA <- eada |>
  filter(classification_name == "NCAA Division I-FCS" | 
        classification_name == "NCAA Division I-FBS" | 
        classification_name == "NCAA Division I without football" |
        classification_name == "NCAA Division II with football" |
        classification_name == "NCAA Division II without football" | 
        classification_name == "NCAA Division III with football" |
        classification_name == "NCAA Division III without football")


Q1_NCAA_ep <- quantile(eada_NCAA$ratio_mw_ep, .25)
Q1_NCAA_sa <- quantile(eada_NCAA$ratio_mw_sa, .25)

Q3_NCAA_ep <- quantile(eada_NCAA$ratio_mw_ep, .75)
Q3_NCAA_sa <- quantile(eada_NCAA$ratio_mw_sa, .75)

IQR_NCAA_ep <- IQR(eada_NCAA$ratio_mw_ep)
IQR_NCAA_sa <- IQR(eada_NCAA$ratio_mw_sa)

eada_NCAA <- subset(eada_NCAA, eada_NCAA$ratio_mw_ep> (Q1_NCAA_ep - 1.5*IQR_NCAA_ep) & eada_NCAA$ratio_mw_ep< (Q3_NCAA_ep + 1.5*IQR_NCAA_ep))

eada_NCAA <- subset(eada_NCAA, eada_NCAA$ratio_mw_sa> (Q1_NCAA_sa - 1.5*IQR_NCAA_sa) & eada_NCAA$ratio_mw_sa< (Q3_NCAA_sa + 1.5*IQR_NCAA_sa))
```

```{r}
#| label: filter-private

eada_private <- eada |>
  filter(sector_name == "Private nonprofit, 4-year or above" | 
         sector_name == "Private for-profit, 4-year or above")



Q1_priv_ep <- quantile(eada_private$ratio_mw_ep, .25)
Q1_priv_sa <- quantile(eada_private$ratio_mw_sa, .25)

Q3_priv_ep <- quantile(eada_private$ratio_mw_ep, .75)
Q3_priv_sa <- quantile(eada_private$ratio_mw_sa, .75)

IQR_priv_ep <- IQR(eada_private$ratio_mw_ep)
IQR_priv_sa <- IQR(eada_private$ratio_mw_sa)

eada_private <- subset(eada_private, eada_private$ratio_mw_ep> (Q1_priv_ep - 1.5*IQR_priv_ep) & eada_private$ratio_mw_ep< (Q3_priv_ep + 1.5*IQR_priv_ep))

eada_private <- subset(eada_private, eada_private$ratio_mw_sa> (Q1_priv_sa - 1.5*IQR_priv_sa) & eada_private$ratio_mw_sa< (Q3_priv_sa + 1.5*IQR_priv_sa))
```

```{r}
#| label: filter-public

eada_public <- eada |>
  filter(sector_name == "Public, 4-year or above" | 
         sector_name == "Public, 2-year")

Q1_public_ep <- quantile(eada_public$ratio_mw_ep, .25)
Q1_public_sa <- quantile(eada_public$ratio_mw_sa, .25)

Q3_public_ep <- quantile(eada_public$ratio_mw_ep, .75)
Q3_public_sa <- quantile(eada_public$ratio_mw_sa, .75)

IQR_public_ep <- IQR(eada_public$ratio_mw_ep)
IQR_public_sa <- IQR(eada_public$ratio_mw_sa)

eada_public <- subset(eada_public, eada_public$ratio_mw_ep> (Q1_public_ep - 1.5*IQR_public_ep) & eada_public$ratio_mw_ep< (Q3_public_ep + 1.5*IQR_public_ep))

eada_public <- subset(eada_public, eada_public$ratio_mw_sa> (Q1_public_sa - 1.5*IQR_public_sa) & eada_public$ratio_mw_sa< (Q3_public_sa + 1.5*IQR_public_sa))
```

```{r}
#| label: filter-nofootball

eada_nofootball <- eada |>
  filter(classification_name == "NCAA Division I without football" |
        classification_name == "NCAA Division II without football" | 
        classification_name == "NCAA Division III without football")

Q1_nofootball_ep <- quantile(eada_nofootball$ratio_mw_ep, .25)
Q1_nofootball_sa <- quantile(eada_nofootball$ratio_mw_sa, .25)

Q3_nofootball_ep <- quantile(eada_nofootball$ratio_mw_ep, .75)
Q3_nofootball_sa <- quantile(eada_nofootball$ratio_mw_sa, .75)

IQR_nofootball_ep <- IQR(eada_nofootball$ratio_mw_ep)
IQR_nofootball_sa <- IQR(eada_nofootball$ratio_mw_sa)

eada_nofootball <- subset(eada_nofootball, eada_nofootball$ratio_mw_ep> (Q1_nofootball_ep - 1.5*IQR_nofootball_ep) & eada_nofootball$ratio_mw_ep< (Q3_nofootball_ep + 1.5*IQR_nofootball_ep))

eada_nofootball <- subset(eada_nofootball, eada_nofootball$ratio_mw_sa> (Q1_nofootball_sa - 1.5*IQR_nofootball_sa) & eada_nofootball$ratio_mw_sa< (Q3_nofootball_sa + 1.5*IQR_nofootball_sa))
```

```{r}
#| label: filter-football

eada_football <- eada |>
  filter(classification_name != "NCAA Division I without football" | 
         classification_name != "NCAA Division II without football" | 
         classification_name != "NCAA Division III without football")

Q1_football_ep <- quantile(eada_football$ratio_mw_ep, .25)
Q1_football_sa <- quantile(eada_football$ratio_mw_sa, .25)

Q3_football_ep <- quantile(eada_football$ratio_mw_ep, .75)
Q3_football_sa <- quantile(eada_football$ratio_mw_sa, .75)

IQR_football_ep <- IQR(eada_football$ratio_mw_ep)
IQR_football_sa <- IQR(eada_football$ratio_mw_sa)

eada_football <- subset(eada_football, eada_football$ratio_mw_ep> (Q1_football_ep - 1.5*IQR_football_ep) & eada_football$ratio_mw_ep< (Q3_football_ep + 1.5*IQR_football_ep))

eada_football <- subset(eada_football, eada_football$ratio_mw_sa> (Q1_football_sa - 1.5*IQR_football_sa) & eada_football$ratio_mw_sa< (Q3_football_sa + 1.5*IQR_football_sa))
```

```{r}
#| label: filter-divisionI

eada_divisionI <- eada |>
  filter(classification_name == "NCAA Division I-FCS" |
         classification_name == "NCAA Division I-FBS" |
         classification_name == "NCAA Division I without football")


Q1_divisionI_ep <- quantile(eada_divisionI$ratio_mw_ep, .25)
Q1_divisionI_sa <- quantile(eada_divisionI$ratio_mw_sa, .25)

Q3_divisionI_ep <- quantile(eada_divisionI$ratio_mw_ep, .75)
Q3_divisionI_sa <- quantile(eada_divisionI$ratio_mw_sa, .75)

IQR_divisionI_ep <- IQR(eada_divisionI$ratio_mw_ep)
IQR_divisionI_sa <- IQR(eada_divisionI$ratio_mw_sa)

eada_divisionI <- subset(eada_divisionI, eada_divisionI$ratio_mw_ep> (Q1_divisionI_ep - 1.5*IQR_divisionI_ep) & eada_divisionI$ratio_mw_ep< (Q3_divisionI_ep + 1.5*IQR_divisionI_ep))

eada_divisionI <- subset(eada_divisionI, eada_divisionI$ratio_mw_sa> (Q1_divisionI_sa - 1.5*IQR_divisionI_sa) & eada_divisionI$ratio_mw_sa< (Q3_divisionI_sa + 1.5*IQR_divisionI_sa))
```

```{r}
#| label: filter-divisionII

eada_divisionII <- eada |>
  filter(classification_name == "NCAA Division II with football" |
        classification_name == "NCAA Division II without football")

Q1_divisionII_ep <- quantile(eada_divisionII$ratio_mw_ep, .25)
Q1_divisionII_sa <- quantile(eada_divisionII$ratio_mw_sa, .25)

Q3_divisionII_ep <- quantile(eada_divisionII$ratio_mw_ep, .75)
Q3_divisionII_sa <- quantile(eada_divisionII$ratio_mw_sa, .75)

IQR_divisionII_ep <- IQR(eada_divisionII$ratio_mw_ep)
IQR_divisionII_sa <- IQR(eada_divisionII$ratio_mw_sa)

eada_divisionII <- subset(eada_divisionII, eada_divisionII$ratio_mw_ep> (Q1_divisionII_ep - 1.5*IQR_divisionII_ep) & eada_divisionII$ratio_mw_ep< (Q3_divisionII_ep + 1.5*IQR_divisionII_ep))

eada_divisionII <- subset(eada_divisionII, eada_divisionII$ratio_mw_sa> (Q1_divisionII_sa - 1.5*IQR_divisionII_sa) & eada_divisionII$ratio_mw_sa< (Q3_divisionII_sa + 1.5*IQR_divisionII_sa))
```

```{r}
#| label: filter-divisionIII

eada_divisionIII <- eada |>
  filter(classification_name == "NCAA Division III with football" |
         classification_name == "NCAA Division III without football")

Q1_divisionIII_ep <- quantile(eada_divisionIII$ratio_mw_ep, .25)
Q1_divisionIII_sa <- quantile(eada_divisionIII$ratio_mw_sa, .25)

Q3_divisionIII_ep <- quantile(eada_divisionIII$ratio_mw_ep, .75)
Q3_divisionIII_sa <- quantile(eada_divisionIII$ratio_mw_sa, .75)

IQR_divisionIII_ep <- IQR(eada_divisionIII$ratio_mw_ep)
IQR_divisionIII_sa <- IQR(eada_divisionIII$ratio_mw_sa)

eada_divisionIII <- subset(eada_divisionIII, eada_divisionIII$ratio_mw_ep> (Q1_divisionIII_ep - 1.5*IQR_divisionIII_ep) & eada_divisionIII$ratio_mw_ep< (Q3_divisionIII_ep + 1.5*IQR_divisionIII_ep))

eada_divisionIII <- subset(eada_divisionIII, eada_divisionIII$ratio_mw_sa> (Q1_divisionIII_sa - 1.5*IQR_divisionIII_sa) & eada_divisionIII$ratio_mw_sa< (Q3_divisionIII_sa + 1.5*IQR_divisionIII_sa))
```

```{r}
#label: main-visualization

eada |>
  ggplot(
    aes(x = ratio_mw_sa,
        y = ratio_mw_ep)
  ) + geom_point()
```

```{r}
#label: AIC-main
linear_reg() |>
  set_engine("lm") |>
  fit(ratio_mw_ep ~ ratio_mw_sa, data = eada) |>
  glance() |>
  pull(AIC)
```

```{r}
#label: viz-priv
eada_private |>
  ggplot(
    aes(x = ratio_mw_sa,
        y = ratio_mw_ep)) + 
  geom_point()

```

```{r}
#label: AIC-priv
linear_reg() |>
  set_engine("lm") |>
  fit(ratio_mw_ep ~ ratio_mw_sa, data = eada_private) |>
  glance() |>
  pull(AIC)

```

```{r}
#label: viz-public
eada_public |>
  ggplot(
    aes(x = ratio_mw_sa,
        y = ratio_mw_ep)
  ) + geom_point()
```

```{r}
#label: AIC-public
linear_reg() |>
  set_engine("lm") |>
  fit(ratio_mw_ep ~ ratio_mw_sa, data = eada_public) |>
  glance() |>
  pull(AIC)
```

```{r}
#label: viz-football
eada_football |>
  ggplot(
    aes(x = ratio_mw_sa,
        y = ratio_mw_ep)
  ) + geom_point()
```

```{r}
#label: AIC-football
linear_reg() |>
  set_engine("lm") |>
  fit(ratio_mw_ep ~ ratio_mw_sa, data = eada_football) |>
  glance() |>
  pull(AIC)
```

```{r}
#label: viz-no-football
eada_nofootball |>
  ggplot(
    aes(x = ratio_mw_sa,
        y = ratio_mw_ep)
  ) + geom_point()
```

```{r}
#label: AIC-no-football
linear_reg() |>
  set_engine("lm") |>
  fit(ratio_mw_ep ~ ratio_mw_sa, data = eada_nofootball) |>
  glance() |>
  pull(AIC)
```

```{r}
#label: viz-d1
eada_divisionI |>
  ggplot(
    aes(x = ratio_mw_sa,
        y = ratio_mw_ep)
  ) + geom_point()
```

```{r}
#label: AIC-d1
linear_reg() |>
  set_engine("lm") |>
  fit(ratio_mw_ep ~ ratio_mw_sa, data = eada_divisionI) |>
  glance() |>
  pull(AIC)
```

```{r}
#label: viz-d2
eada_divisionII |>
  ggplot(
    aes(x = ratio_mw_sa,
        y = ratio_mw_ep)
  ) + geom_point()
```

```{r}
#label: AIC-d2
linear_reg() |>
  set_engine("lm") |>
  fit(ratio_mw_ep ~ ratio_mw_sa, data = eada_divisionII) |>
  glance() |>
  pull(AIC)
```

```{r}
#label: viz-d3
eada_divisionIII |>
  ggplot(
    aes(x = ratio_mw_sa,
        y = ratio_mw_ep)
  ) + geom_point()

```

```{r}
#label: AIC-d3
linear_reg() |>
  set_engine("lm") |>
  fit(ratio_mw_ep ~ ratio_mw_sa, data = eada_divisionIII) |>
  glance() |>
  pull(AIC)
```
